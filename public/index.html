<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Li Crypto Bot</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap');
        
        :root {
            --primary: #6366f1;
            --primary-glow: #818cf8;
            --secondary: #a855f7;
            --secondary-glow: #c084fc;
            --accent: #06b6d4;
            --accent-glow: #22d3ee;
            --dark: #0f0f23;
            --darker: #070714;
            --neon-shadow: 0 0 20px rgba(99, 102, 241, 0.5);
            --neon-glow: 0 0 30px rgba(99, 102, 241, 0.8);
            --success: #10b981;
            --error: #ef4444;
            --warning: #f59e0b;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Rajdhani', sans-serif;
            background: linear-gradient(135deg, var(--darker) 0%, var(--dark) 50%, #1e1b4b 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        .container {
            max-width: 500px;
            margin: 0 auto;
            padding: 15px;
            position: relative;
            z-index: 1;
        }

        .header {
            text-align: center;
            margin-bottom: 25px;
            position: relative;
        }
        
        .logo {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5em;
            font-weight: 900;
            background: linear-gradient(45deg, var(--primary), var(--secondary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: var(--neon-shadow);
            animation: neonPulse 2s infinite alternate;
            margin-bottom: 10px;
        }
        
        @keyframes neonPulse {
            from { text-shadow: var(--neon-shadow); }
            to { text-shadow: 0 0 30px var(--primary-glow), 0 0 40px var(--secondary-glow); }
        }
        
        .subtitle {
            color: var(--primary-glow);
            font-size: 1.1em;
            font-weight: 300;
        }
        
        .admin-badge {
            background: linear-gradient(45deg, #f59e0b, #d97706);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            margin-left: 10px;
            animation: glow 2s infinite alternate;
        }
        
        @keyframes glow {
            from { box-shadow: 0 0 10px #f59e0b; }
            to { box-shadow: 0 0 20px #f59e0b, 0 0 30px #d97706; }
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 25px;
            margin: 15px 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .btn {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border: none;
            padding: 15px 25px;
            border-radius: 15px;
            color: white;
            font-family: 'Rajdhani', sans-serif;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin: 8px 0;
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.6);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .btn-admin {
            background: linear-gradient(45deg, #f59e0b, #d97706);
            box-shadow: 0 5px 15px rgba(245, 158, 11, 0.4);
        }
        
        .btn-admin:hover {
            box-shadow: 0 8px 25px rgba(245, 158, 11, 0.6);
        }
        
        .tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 5px;
            margin: 20px 0;
            backdrop-filter: blur(10px);
            flex-wrap: wrap;
        }
        
        .tab-btn {
            flex: 1;
            padding: 12px;
            background: transparent;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            font-family: 'Rajdhani', sans-serif;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 80px;
        }
        
        .tab-btn.active {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4);
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .balance-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .input-group {
            margin: 15px 0;
        }
        
        .input-label {
            display: block;
            margin-bottom: 8px;
            color: var(--primary-glow);
            font-weight: 600;
        }
        
        .input-field {
            width: 100%;
            padding: 15px;
            border: 2px solid rgba(99, 102, 241, 0.3);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.05);
            color: white;
            font-family: 'Rajdhani', sans-serif;
            font-size: 1.1em;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            transform: translateX(400px);
            transition: transform 0.5s ease;
            z-index: 1000;
            max-width: 300px;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.error {
            background: linear-gradient(45deg, var(--error), #dc2626);
        }
        
        .notification.success {
            background: linear-gradient(45deg, var(--success), #059669);
        }
        
        .notification.warning {
            background: linear-gradient(45deg, var(--warning), #d97706);
        }
        
        .check-url {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            word-break: break-all;
            font-size: 14px;
        }
        
        .copy-btn {
            background: var(--accent);
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            margin-left: 10px;
        }

        .rub-conversion {
            color: var(--accent-glow);
            font-size: 0.9em;
            margin-top: 5px;
            text-align: right;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }

        .modal {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 25px;
            max-width: 400px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .modal-buttons .btn {
            flex: 1;
            margin: 0;
        }

        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .transaction-type {
            font-size: 1.5em;
            margin-right: 10px;
        }

        .transaction-outgoing {
            color: var(--error);
        }

        .transaction-incoming {
            color: var(--success);
        }

        .transaction-details {
            flex: 1;
        }

        .transaction-amount {
            font-weight: 700;
            font-size: 1.1em;
        }

        .admin-section {
            border-left: 3px solid #f59e0b;
            padding-left: 15px;
            margin: 20px 0;
        }

        .admin-section h4 {
            color: #f59e0b;
            margin-bottom: 10px;
        }

        .user-status {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.8em;
            font-weight: 600;
            margin-left: 8px;
        }

        .status-active {
            background: var(--success);
            color: white;
        }

        .status-blocked {
            background: var(--error);
            color: white;
        }

        .status-admin {
            background: #f59e0b;
            color: white;
        }

        .blocked-message {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid var(--error);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin: 20px 0;
        }

        .blocked-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .transfer-status {
            background: rgba(99, 102, 241, 0.2);
            border: 1px solid var(--primary);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
        }

        .countdown {
            font-size: 1.2em;
            font-weight: 700;
            color: var(--accent-glow);
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">LiCRYPTO</div>
            <div class="subtitle">LCOIN ‚Ä¢ –ß–µ–∫–∏ ‚Ä¢ –ì—Ä–∞—Ñ–∏–∫–∏ <span id="adminBadge" class="admin-badge" style="display: none;">ADMIN</span></div>
        </div>

        <!-- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
        <div id="blockedMessage" class="blocked-message" style="display: none;">
            <div class="blocked-icon">üö´</div>
            <h3>–î–æ—Å—Ç—É–ø –æ–≥—Ä–∞–Ω–∏—á–µ–Ω</h3>
            <p id="blockReason"></p>
            <p style="margin-top: 10px; font-size: 0.9em; opacity: 0.8;">
                –î–ª—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
            </p>
        </div>

        <div id="mainContent">
            <div class="glass-card">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <div style="font-size: 1.2em; font-weight: 600;" id="userName">–¢—Ä–µ–π–¥–µ—Ä</div>
                        <div style="color: var(--primary-glow); font-size: 0.9em;">
                            –£—Ä–æ–≤–µ–Ω—å <span id="userLevel">1</span>
                            <span id="userStatus" class="user-status status-active">–ê–ö–¢–ò–í–ï–ù</span>
                        </div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 0.9em; color: var(--primary-glow);">–ë–∞–ª–∞–Ω—Å</div>
                        <div style="font-weight: 600;" id="totalBalance">-</div>
                    </div>
                </div>
            </div>

            <div class="tabs">
                <button class="tab-btn active" onclick="showTab('balance')">
                    <i class="fas fa-coins"></i> –ë–∞–ª–∞–Ω—Å
                </button>
                <button class="tab-btn" onclick="showTab('transfer')">
                    <i class="fas fa-exchange-alt"></i> –ü–µ—Ä–µ–≤–æ–¥
                </button>
                <button class="tab-btn" onclick="showTab('checks')">
                    <i class="fas fa-receipt"></i> –ß–µ–∫–∏
                </button>
                <button class="tab-btn" onclick="showTab('history')">
                    <i class="fas fa-history"></i> –ò—Å—Ç–æ—Ä–∏—è
                </button>
                <button class="tab-btn" id="adminTab" onclick="showTab('admin')" style="display: none;">
                    <i class="fas fa-crown"></i> –ê–¥–º–∏–Ω
                </button>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –ë–∞–ª–∞–Ω—Å -->
            <div id="balance" class="tab-content active">
                <div class="glass-card">
                    <h3 style="margin-bottom: 20px; color: var(--primary-glow);">
                        <i class="fas fa-coins"></i> –í–∞—à –±–∞–ª–∞–Ω—Å
                    </h3>
                    <div id="balance-list">
                        <!-- –ë–∞–ª–∞–Ω—Å –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
                
                <button class="btn" onclick="loadUserData()">
                    <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å
                </button>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –ü–µ—Ä–µ–≤–æ–¥ -->
            <div id="transfer" class="tab-content">
                <div class="glass-card">
                    <h3 style="margin-bottom: 20px; color: var(--primary-glow);">
                        <i class="fas fa-paper-plane"></i> –ü–µ—Ä–µ–≤–æ–¥
                    </h3>
                    
                    <div class="input-group">
                        <label class="input-label">–ü–æ–ª—É—á–∞—Ç–µ–ª—å (@username)</label>
                        <input type="text" id="toUsername" class="input-field" placeholder="username" oninput="updateTransferPreview()">
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">–í–∞–ª—é—Ç–∞</label>
                        <select id="currency" class="input-field" onchange="updateTransferPreview()">
                            <option value="USDT">üíµ Tether (USDT)</option>
                            <option value="BTC">‚Çø Bitcoin (BTC)</option>
                            <option value="ETH">Œû Ethereum (ETH)</option>
                            <option value="LCOIN">ü™ô LCoin (LCOIN)</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">–°—É–º–º–∞</label>
                        <input type="number" id="amount" class="input-field" placeholder="0.00" step="0.0001" oninput="updateTransferPreview()">
                        <div class="rub-conversion" id="rubConversion">~ 0 RUB</div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –ø–µ—Ä–µ–≤–æ–¥—É (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                        <input type="text" id="transferMessage" class="input-field" placeholder="–ó–∞ –ø–µ—Ä–µ–≤–æ–¥..." oninput="updateTransferPreview()">
                    </div>

                    <div id="transferPreview" style="display: none; background: rgba(255,255,255,0.05); padding: 15px; border-radius: 10px; margin: 15px 0;">
                        <h4 style="color: var(--primary-glow); margin-bottom: 10px;">üìã –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –ø–µ—Ä–µ–≤–æ–¥–∞:</h4>
                        <div id="previewDetails"></div>
                    </div>
                    
                    <button class="btn" onclick="showTransferConfirmation()" id="transferBtn">
                        <i class="fas fa-rocket"></i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥
                    </button>
                </div>

                <!-- –°—Ç–∞—Ç—É—Å –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞ -->
                <div id="activeTransfer" class="transfer-status" style="display: none;">
                    <h4 style="color: var(--primary-glow); margin-bottom: 10px;">‚è≥ –ü–µ—Ä–µ–≤–æ–¥ –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ</h4>
                    <div id="transferDetails"></div>
                    <div class="countdown" id="countdown">30 —Å–µ–∫</div>
                    <div style="font-size: 0.9em; opacity: 0.8;">
                        –°—Ä–µ–¥—Å—Ç–≤–∞ –±—É–¥—É—Ç –∑–∞—á–∏—Å–ª–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
                    </div>
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –ß–µ–∫–∏ -->
            <div id="checks" class="tab-content">
                <div class="glass-card">
                    <h3 style="margin-bottom: 20px; color: var(--primary-glow);">
                        <i class="fas fa-gift"></i> –°–æ–∑–¥–∞—Ç—å —á–µ–∫
                    </h3>
                    
                    <div class="input-group">
                        <label class="input-label">–°—É–º–º–∞</label>
                        <input type="number" id="checkAmount" class="input-field" placeholder="100" value="100" step="0.0001" oninput="updateCheckPreview()">
                        <div class="rub-conversion" id="checkRubConversion">~ 0 RUB</div>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">–í–∞–ª—é—Ç–∞</label>
                        <select id="checkCurrency" class="input-field" onchange="updateCheckPreview()">
                            <option value="USDT">üíµ Tether (USDT)</option>
                            <option value="LCOIN">ü™ô LCoin (LCOIN)</option>
                            <option value="BTC">‚Çø Bitcoin (BTC)</option>
                            <option value="ETH">Œû Ethereum (ETH)</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">–°–æ–æ–±—â–µ–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                        <input type="text" id="checkMessage" class="input-field" placeholder="–ü–æ–∑–¥—Ä–∞–≤–ª—è—é!">
                    </div>

                    <div class="input-group">
                        <label class="input-label">–ü–∞—Ä–æ–ª—å –¥–ª—è —á–µ–∫–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                        <input type="password" id="checkPassword" class="input-field" placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è —á–µ–∫–∞ –±–µ–∑ –ø–∞—Ä–æ–ª—è">
                        <div style="font-size: 0.8em; color: var(--accent-glow); margin-top: 5px;">
                            üîí –¢–æ–ª—å–∫–æ –∑–Ω–∞—è –ø–∞—Ä–æ–ª—å –º–æ–∂–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —á–µ–∫
                        </div>
                    </div>

                    <div id="checkPreview" style="display: none; background: rgba(255,255,255,0.05); padding: 15px; border-radius: 10px; margin: 15px 0;">
                        <h4 style="color: var(--primary-glow); margin-bottom: 10px;">üéÅ –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —á–µ–∫–∞:</h4>
                        <div id="checkPreviewDetails"></div>
                    </div>
                    
                    <button class="btn" onclick="createCheck()" id="createCheckBtn">
                        <i class="fas fa-gift"></i> –°–æ–∑–¥–∞—Ç—å —á–µ–∫
                    </button>
                    
                    <div id="checkResult" style="display: none; margin-top: 20px;">
                        <div class="check-url">
                            <strong>–°—Å—ã–ª–∫–∞ –Ω–∞ —á–µ–∫:</strong>
                            <div id="checkUrl" style="margin: 10px 0;"></div>
                            <button class="copy-btn" onclick="copyCheckUrl()">
                                <i class="fas fa-copy"></i> –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –ò—Å—Ç–æ—Ä–∏—è -->
            <div id="history" class="tab-content">
                <div class="glass-card">
                    <h3 style="margin-bottom: 20px; color: var(--primary-glow);">
                        <i class="fas fa-history"></i> –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
                    </h3>
                    <div id="transactionsList">
                        <!-- –ò—Å—Ç–æ—Ä–∏—è –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
                
                <button class="btn" onclick="loadUserData()">
                    <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é
                </button>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –ê–¥–º–∏–Ω -->
            <div id="admin" class="tab-content">
                <div class="glass-card">
                    <h3 style="margin-bottom: 20px; color: #f59e0b;">
                        <i class="fas fa-crown"></i> –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
                    </h3>

                    <div class="admin-section">
                        <h4>üí∞ –í—ã–¥–∞—Ç—å –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—É</h4>
                        <div class="input-group">
                            <label class="input-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (@username)</label>
                            <input type="text" id="adminTargetUser" class="input-field" placeholder="username">
                        </div>
                        <div class="input-group">
                            <label class="input-label">–í–∞–ª—é—Ç–∞</label>
                            <select id="adminCurrency" class="input-field">
                                <option value="USDT">üíµ Tether (USDT)</option>
                                <option value="BTC">‚Çø Bitcoin (BTC)</option>
                                <option value="ETH">Œû Ethereum (ETH)</option>
                                <option value="LCOIN">ü™ô LCoin (LCOIN)</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label class="input-label">–°—É–º–º–∞</label>
                            <input type="number" id="adminAmount" class="input-field" placeholder="100" step="0.0001">
                        </div>
                        <button class="btn btn-admin" onclick="adminAddCrypto()">
                            <i class="fas fa-gift"></i> –í—ã–¥–∞—Ç—å –∫—Ä–∏–ø—Ç—É
                        </button>
                    </div>

                    <div class="admin-section">
                        <h4>üîí –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º–∏</h4>
                        <div class="input-group">
                            <label class="input-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (@username)</label>
                            <input type="text" id="blockTargetUser" class="input-field" placeholder="username">
                        </div>
                        <div class="input-group">
                            <label class="input-label">–ü—Ä–∏—á–∏–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏</label>
                            <input type="text" id="blockReason" class="input-field" placeholder="–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª">
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-admin" onclick="adminBlockUser()" style="flex: 1;">
                                <i class="fas fa-ban"></i> –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
                            </button>
                            <button class="btn btn-secondary" onclick="adminUnblockUser()" style="flex: 1;">
                                <i class="fas fa-check"></i> –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
                            </button>
                        </div>
                    </div>

                    <div class="admin-section">
                        <h4>üë• –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h4>
                        <div id="blockedUsersList">
                            <!-- –°–ø–∏—Å–æ–∫ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                        <button class="btn btn-secondary" onclick="loadBlockedUsers()">
                            <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–µ—Ä–µ–≤–æ–¥–∞ -->
    <div id="transferModal" class="modal-overlay" style="display: none;">
        <div class="modal">
            <h3 style="color: var(--primary-glow); margin-bottom: 15px;">ü§î –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–µ—Ä–µ–≤–æ–¥</h3>
            <div id="modalTransferDetails"></div>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="hideTransferModal()">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn" onclick="performTransfer()">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <div class="notification" id="notification">
        –°–æ–æ–±—â–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    </div>

    <script>
        let currentUser = null;
        let tg = null;
        let exchangeRates = {};
        let activeTransferInterval = null;

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç
        async function loadExchangeRates() {
            try {
                const response = await fetch('/api/crypto');
                const data = await response.json();
                exchangeRates = data;
                updateTransferPreview();
                updateCheckPreview();
            } catch (error) {
                console.error('Error loading exchange rates:', error);
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–µ—Ä–µ–≤–æ–¥–∞
        function updateTransferPreview() {
            const amount = parseFloat(document.getElementById('amount').value);
            const currency = document.getElementById('currency').value;
            const toUsername = document.getElementById('toUsername').value.trim();
            const message = document.getElementById('transferMessage').value.trim();
            
            const preview = document.getElementById('transferPreview');
            const details = document.getElementById('previewDetails');
            const rubConversion = document.getElementById('rubConversion');
            
            if (amount && amount > 0 && toUsername) {
                let rubAmount = calculateRubAmount(amount, currency);
                rubConversion.textContent = `~ ${rubAmount.toFixed(2)} RUB`;
                
                details.innerHTML = `
                    <div>üë§ –ö–æ–º—É: @${toUsername}</div>
                    <div>üí∞ –°—É–º–º–∞: ${amount} ${currency}</div>
                    <div>üí∏ –í —Ä—É–±–ª—è—Ö: ~ ${rubAmount.toFixed(2)} RUB</div>
                    ${message ? `<div>üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: "${message}"</div>` : ''}
                `;
                preview.style.display = 'block';
            } else {
                preview.style.display = 'none';
                rubConversion.textContent = '~ 0 RUB';
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —á–µ–∫–∞
        function updateCheckPreview() {
            const amount = parseFloat(document.getElementById('checkAmount').value);
            const currency = document.getElementById('checkCurrency').value;
            
            const preview = document.getElementById('checkPreview');
            const details = document.getElementById('checkPreviewDetails');
            const rubConversion = document.getElementById('checkRubConversion');
            
            if (amount && amount > 0) {
                let rubAmount = calculateRubAmount(amount, currency);
                rubConversion.textContent = `~ ${rubAmount.toFixed(2)} RUB`;
                
                details.innerHTML = `
                    <div>üí∞ –°—É–º–º–∞: ${amount} ${currency}</div>
                    <div>üí∏ –í —Ä—É–±–ª—è—Ö: ~ ${rubAmount.toFixed(2)} RUB</div>
                `;
                preview.style.display = 'block';
            } else {
                preview.style.display = 'none';
                rubConversion.textContent = '~ 0 RUB';
            }
        }

        // –†–∞—Å—á–µ—Ç —Å—É–º–º—ã –≤ —Ä—É–±–ª—è—Ö
        function calculateRubAmount(amount, currency) {
            let rubAmount = 0;
            if (currency === 'USDT' && exchangeRates.tether) {
                rubAmount = amount * exchangeRates.tether.rub;
            } else if (currency === 'BTC' && exchangeRates.bitcoin) {
                rubAmount = amount * exchangeRates.bitcoin.rub;
            } else if (currency === 'ETH' && exchangeRates.ethereum) {
                rubAmount = amount * exchangeRates.ethereum.rub;
            } else if (currency === 'LCOIN' && exchangeRates.lcoin) {
                rubAmount = amount * exchangeRates.lcoin.rub;
            }
            return rubAmount;
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
        function showTransferConfirmation() {
            const toUsername = document.getElementById('toUsername').value.trim();
            const currency = document.getElementById('currency').value;
            const amount = parseFloat(document.getElementById('amount').value);
            const message = document.getElementById('transferMessage').value;

            if (!toUsername || !amount || amount <= 0) {
                showNotification('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ!', 'error');
                return;
            }

            const rubAmount = calculateRubAmount(amount, currency);

            const modal = document.getElementById('transferModal');
            const modalDetails = document.getElementById('modalTransferDetails');
            
            modalDetails.innerHTML = `
                <div style="margin-bottom: 15px;">
                    <div><strong>üë§ –ü–æ–ª—É—á–∞—Ç–µ–ª—å:</strong> @${toUsername}</div>
                    <div><strong>üí∞ –°—É–º–º–∞:</strong> ${amount} ${currency}</div>
                    <div><strong>üí∏ –í —Ä—É–±–ª—è—Ö:</strong> ~ ${rubAmount.toFixed(2)} RUB</div>
                    ${message ? `<div><strong>üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</strong> "${message}"</div>` : ''}
                </div>
                <div style="color: var(--accent-glow); font-size: 0.9em;">
                    ‚è∞ –ü–µ—Ä–µ–≤–æ–¥ –∑–∞–π–º–µ—Ç 30 —Å–µ–∫—É–Ω–¥<br>
                    ‚ö†Ô∏è –ü–µ—Ä–µ–≤–æ–¥ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
                </div>
            `;
            
            modal.style.display = 'flex';
        }

        // –°–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        function hideTransferModal() {
            document.getElementById('transferModal').style.display = 'none';
        }

        // –í—ã–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥
        async function performTransfer() {
            const toUsername = document.getElementById('toUsername').value.trim();
            const currency = document.getElementById('currency').value;
            const amount = parseFloat(document.getElementById('amount').value);
            const message = document.getElementById('transferMessage').value;

            hideTransferModal();

            try {
                const tg = window.Telegram.WebApp;
                const fromUserId = tg.initDataUnsafe?.user?.id?.toString();

                if (!fromUserId) {
                    showNotification('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'error');
                    return;
                }

                const transferBtn = document.getElementById('transferBtn');
                transferBtn.disabled = true;
                transferBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> –û—Ç–ø—Ä–∞–≤–∫–∞...';

                const response = await fetch('/api/transfer/initiate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        fromUserId: fromUserId,
                        toUsername: toUsername,
                        currency: currency,
                        amount: amount,
                        message: message
                    })
                });

                const result = await response.json();

                if (result.success) {
                    showNotification(`‚è≥ –ü–µ—Ä–µ–≤–æ–¥ ${amount} ${currency} initiated!`, 'success');
                    document.getElementById('toUsername').value = '';
                    document.getElementById('amount').value = '';
                    document.getElementById('transferMessage').value = '';
                    document.getElementById('transferPreview').style.display = 'none';
                    
                    showTransferStatus(result.transferId, amount, currency, toUsername);
                } else {
                    showNotification(result.error || '‚ùå –û—à–∏–±–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–∞', 'error');
                }
            } catch (error) {
                console.error('Transfer error:', error);
                showNotification('‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ –ø–µ—Ä–µ–≤–æ–¥–µ', 'error');
            } finally {
                const transferBtn = document.getElementById('transferBtn');
                transferBtn.disabled = false;
                transferBtn.innerHTML = '<i class="fas fa-rocket"></i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥';
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞
        function showTransferStatus(transferId, amount, currency, toUsername) {
            const activeTransfer = document.getElementById('activeTransfer');
            const transferDetails = document.getElementById('transferDetails');
            const countdown = document.getElementById('countdown');
            
            transferDetails.innerHTML = `
                <div>${amount} ${currency} ‚Üí @${toUsername}</div>
            `;
            
            activeTransfer.style.display = 'block';
            
            let secondsLeft = 30;
            updateCountdown();
            
            activeTransferInterval = setInterval(() => {
                secondsLeft--;
                updateCountdown();
                
                if (secondsLeft <= 0) {
                    clearInterval(activeTransferInterval);
                    activeTransfer.style.display = 'none';
                    loadUserData();
                }
            }, 1000);
            
            function updateCountdown() {
                countdown.textContent = `${secondsLeft} —Å–µ–∫`;
            }
        }

        // –°–æ–∑–¥–∞—Ç—å —á–µ–∫
        async function createCheck() {
            const amount = parseFloat(document.getElementById('checkAmount').value);
            const currency = document.getElementById('checkCurrency').value;
            const message = document.getElementById('checkMessage').value.trim();
            const password = document.getElementById('checkPassword').value.trim();

            if (!amount || amount <= 0) {
                showNotification('‚ùå –í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—É–º–º—É', 'error');
                return;
            }

            try {
                const tg = window.Telegram.WebApp;
                const userId = tg.initDataUnsafe?.user?.id?.toString();

                if (!userId) {
                    showNotification('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'error');
                    return;
                }

                const createCheckBtn = document.getElementById('createCheckBtn');
                createCheckBtn.disabled = true;
                createCheckBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> –°–æ–∑–¥–∞–Ω–∏–µ...';

                const response = await fetch('/api/checks/create', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        userId: userId,
                        amount: amount,
                        currency: currency,
                        message: message,
                        password: password || null
                    })
                });

                const result = await response.json();

                if (result.success) {
                    showNotification(`‚úÖ –ß–µ–∫ –Ω–∞ ${amount} ${currency} —Å–æ–∑–¥–∞–Ω!`, 'success');
                    
                    const checkResult = document.getElementById('checkResult');
                    const checkUrl = document.getElementById('checkUrl');
                    checkUrl.innerHTML = `<a href="${result.checkUrl}" target="_blank" style="color: var(--accent-glow);">${result.checkUrl}</a>`;
                    checkResult.style.display = 'block';
                    
                    document.getElementById('checkAmount').value = '';
                    document.getElementById('checkMessage').value = '';
                    document.getElementById('checkPassword').value = '';
                    document.getElementById('checkPreview').style.display = 'none';
                    
                    await loadUserData();
                } else {
                    showNotification(result.error || '‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —á–µ–∫–∞', 'error');
                }
            } catch (error) {
                console.error('Check creation error:', error);
                showNotification('‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —á–µ–∫–∞', 'error');
            } finally {
                const createCheckBtn = document.getElementById('createCheckBtn');
                createCheckBtn.disabled = false;
                createCheckBtn.innerHTML = '<i class="fas fa-gift"></i> –°–æ–∑–¥–∞—Ç—å —á–µ–∫';
            }
        }

        // –ê–¥–º–∏–Ω: –≤—ã–¥–∞—Ç—å –∫—Ä–∏–ø—Ç—É
        async function adminAddCrypto() {
            const targetUsername = document.getElementById('adminTargetUser').value.trim();
            const currency = document.getElementById('adminCurrency').value;
            const amount = parseFloat(document.getElementById('adminAmount').value);

            if (!targetUsername || !amount || amount <= 0) {
                showNotification('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ!', 'error');
                return;
            }

            try {
                const tg = window.Telegram.WebApp;
                const adminUserId = tg.initDataUnsafe?.user?.id?.toString();

                const response = await fetch('/api/admin/add-crypto', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        adminUserId: adminUserId,
                        targetUsername: targetUsername,
                        currency: currency,
                        amount: amount
                    })
                });

                const result = await response.json();

                if (result.success) {
                    showNotification(result.message, 'success');
                    document.getElementById('adminTargetUser').value = '';
                    document.getElementById('adminAmount').value = '';
                } else {
                    showNotification(result.error, 'error');
                }
            } catch (error) {
                console.error('Admin add crypto error:', error);
                showNotification('‚ùå –û—à–∏–±–∫–∞ –≤—ã–¥–∞—á–∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã', 'error');
            }
        }

        // –ê–¥–º–∏–Ω: –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        async function adminBlockUser() {
            const targetUsername = document.getElementById('blockTargetUser').value.trim();
            const reason = document.getElementById('blockReason').value.trim();

            if (!targetUsername || !reason) {
                showNotification('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!', 'error');
                return;
            }

            try {
                const tg = window.Telegram.WebApp;
                const adminUserId = tg.initDataUnsafe?.user?.id?.toString();

                const response = await fetch('/api/admin/block-user', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        adminUserId: adminUserId,
                        targetUsername: targetUsername,
                        reason: reason
                    })
                });

                const result = await response.json();

                if (result.success) {
                    showNotification(result.message, 'success');
                    document.getElementById('blockTargetUser').value = '';
                    document.getElementById('blockReason').value = '';
                    loadBlockedUsers();
                } else {
                    showNotification(result.error, 'error');
                }
            } catch (error) {
                console.error('Admin block user error:', error);
                showNotification('‚ùå –û—à–∏–±–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'error');
            }
        }

        // –ê–¥–º–∏–Ω: —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        async function adminUnblockUser() {
            const targetUsername = document.getElementById('blockTargetUser').value.trim();

            if (!targetUsername) {
                showNotification('‚ùå –í–≤–µ–¥–∏—Ç–µ username –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è!', 'error');
                return;
            }

            try {
                const tg = window.Telegram.WebApp;
                const adminUserId = tg.initDataUnsafe?.user?.id?.toString();

                const response = await fetch('/api/admin/unblock-user', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        adminUserId: adminUserId,
                        targetUsername: targetUsername
                    })
                });

                const result = await response.json();

                if (result.success) {
                    showNotification(result.message, 'success');
                    document.getElementById('blockTargetUser').value = '';
                    loadBlockedUsers();
                } else {
                    showNotification(result.error, 'error');
                }
            } catch (error) {
                console.error('Admin unblock user error:', error);
                showNotification('‚ùå –û—à–∏–±–∫–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'error');
            }
        }

        // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        async function loadBlockedUsers() {
            try {
                const tg = window.Telegram.WebApp;
                const adminUserId = tg.initDataUnsafe?.user?.id?.toString();

                const response = await fetch(`/api/admin/blocked-users?adminUserId=${adminUserId}`);
                const result = await response.json();

                const blockedList = document.getElementById('blockedUsersList');
                
                if (result.success && result.blockedUsers.length > 0) {
                    blockedList.innerHTML = result.blockedUsers.map(user => `
                        <div style="padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <div><strong>@${user.username}</strong></div>
                            <div style="font-size: 0.9em; color: var(--accent-glow);">${user.reason}</div>
                            <div style="font-size: 0.8em; opacity: 0.7;">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω: ${new Date(user.blockedAt).toLocaleDateString('ru-RU')}</div>
                        </div>
                    `).join('');
                } else {
                    blockedList.innerHTML = '<div style="text-align: center; padding: 20px; opacity: 0.7;">–ù–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>';
                }
            } catch (error) {
                console.error('Load blocked users error:', error);
            }
        }

        // –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ —á–µ–∫
        function copyCheckUrl() {
            const checkUrl = document.getElementById('checkUrl').textContent;
            navigator.clipboard.writeText(checkUrl).then(() => {
                showNotification('‚úÖ –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä!', 'success');
            }).catch(() => {
                showNotification('‚ùå –û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è', 'error');
            });
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification show ${type}`;
            
            setTimeout(() => {
                notification.className = 'notification';
            }, 3000);
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        async function loadUserData() {
            try {
                const tg = window.Telegram.WebApp;
                const userId = tg.initDataUnsafe?.user?.id?.toString();

                if (!userId) {
                    showNotification('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'error');
                    return;
                }

                const response = await fetch(`/api/user/${userId}`);
                
                if (!response.ok) {
                    throw new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö');
                }

                const data = await response.json();
                
                if (data.error === 'USER_BLOCKED') {
                    showBlockedMessage(data.blockInfo);
                    return;
                }

                currentUser = data.user;
                updateUserInterface(data.user, data.transactions);
                
                if (currentUser.isAdmin) {
                    document.getElementById('adminTab').style.display = 'block';
                    document.getElementById('adminBadge').style.display = 'inline-block';
                    document.getElementById('userStatus').className = 'user-status status-admin';
                    document.getElementById('userStatus').textContent = '–ê–î–ú–ò–ù';
                    loadBlockedUsers();
                }

                showNotification('‚úÖ –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã!', 'success');
                
            } catch (error) {
                console.error('Error loading user data:', error);
                if (error.message.includes('403')) {
                    showNotification('‚ùå –í—ã –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã –≤ —Å–∏—Å—Ç–µ–º–µ', 'error');
                } else {
                    showNotification('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö', 'error');
                }
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ
        function showBlockedMessage(blockInfo) {
            document.getElementById('mainContent').style.display = 'none';
            document.getElementById('blockedMessage').style.display = 'block';
            document.getElementById('blockReason').textContent = blockInfo.reason;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function updateUserInterface(user, transactions = []) {
            document.getElementById('userName').textContent = user.first_name || user.username || '–¢—Ä–µ–π–¥–µ—Ä';
            document.getElementById('userLevel').textContent = user.level;
            
            const userStatus = document.getElementById('userStatus');
            userStatus.textContent = user.isAdmin ? '–ê–î–ú–ò–ù' : '–ê–ö–¢–ò–í–ï–ù';
            userStatus.className = `user-status ${user.isAdmin ? 'status-admin' : 'status-active'}`;
            
            const total = Object.values(user.balance).reduce((sum, val) => sum + val, 0);
            document.getElementById('totalBalance').textContent = total.toFixed(2) + ' USD';
            
            const balanceList = document.getElementById('balance-list');
            balanceList.innerHTML = '';
            
            const currencies = [
                { key: 'BTC', name: 'Bitcoin', symbol: '‚Çø' },
                { key: 'ETH', name: 'Ethereum', symbol: 'Œû' },
                { key: 'USDT', name: 'Tether', symbol: 'üíµ' },
                { key: 'LCOIN', name: 'LCoin', symbol: 'ü™ô' }
            ];
            
            currencies.forEach(currency => {
                const balanceItem = document.createElement('div');
                balanceItem.className = 'balance-item';
                balanceItem.innerHTML = `
                    <div>${currency.symbol} ${currency.name} (${currency.key})</div>
                    <div style="font-weight: 700; color: var(--accent);">${user.balance[currency.key]}</div>
                `;
                balanceList.appendChild(balanceItem);
            });
            
            updateTransactionsList(transactions);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
        function updateTransactionsList(transactions) {
            const transactionsList = document.getElementById('transactionsList');
            
            if (transactions.length === 0) {
                transactionsList.innerHTML = '<div style="text-align: center; padding: 40px; opacity: 0.7;">–û–ø–µ—Ä–∞—Ü–∏–π –ø–æ–∫–∞ –Ω–µ—Ç</div>';
                return;
            }
            
            transactionsList.innerHTML = transactions.map(transaction => `
                <div class="transaction-item">
                    <div class="transaction-type ${transaction.type === 'outgoing' ? 'transaction-outgoing' : 'transaction-incoming'}">
                        ${transaction.type === 'outgoing' ? 'üì§' : 'üì•'}
                    </div>
                    <div class="transaction-details">
                        <div style="font-weight: 600;">${transaction.amount} ${transaction.currency}</div>
                        <div style="font-size: 0.9em; opacity: 0.8;">
                            ${transaction.type === 'outgoing' ? '‚Üí' : '‚Üê'} ${transaction.counterparty}
                        </div>
                        ${transaction.message ? `<div style="font-size: 0.8em; color: var(--accent-glow);">"${transaction.message}"</div>` : ''}
                        <div style="font-size: 0.8em; opacity: 0.6;">
                            ${new Date(transaction.timestamp).toLocaleDateString('ru-RU')} ${new Date(transaction.timestamp).toLocaleTimeString('ru-RU')}
                        </div>
                    </div>
                    <div class="transaction-amount ${transaction.type === 'outgoing' ? 'transaction-outgoing' : 'transaction-incoming'}">
                        ${transaction.type === 'outgoing' ? '-' : '+'}${transaction.amount}
                    </div>
                </div>
            `).join('');
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        function initTelegramApp() {
            tg = window.Telegram.WebApp;
            tg.expand();
            tg.ready();

            console.log('Telegram Web App initialized:', tg.initDataUnsafe);
            
            setTimeout(() => {
                loadUserData();
                loadExchangeRates();
            }, 1000);

            setInterval(loadExchangeRates, 30000);

            showNotification('LiCrypto Bot –∑–∞–≥—Ä—É–∂–µ–Ω! üöÄ', 'success');
        }

        // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –∫–æ–≥–¥–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞
        document.addEventListener('DOMContentLoaded', function() {
            initTelegramApp();
        });
    </script>
</body>
</html>
